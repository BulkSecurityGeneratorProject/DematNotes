<mat-tab-group>

    <!-- Saisie des notes -->
    <mat-tab label="Saisie des notes">
        <span>Saisie des notes</span>
        <!-- Listes déroulante -->
        <mat-form-field>
            <mat-select name="schoolSelected" [(ngModel)]="schoolSelected" (ngModelChange)="getClassroomsByCurrentUserTeacher()" placeholder="Ecoles">
                <mat-option *ngFor="let school of schools" [value]="school.id">
                    {{ school.wording }} - {{school.city}}
                </mat-option>
            </mat-select>
        </mat-form-field>

        <mat-form-field *ngIf="schoolSelected && this.classrooms.length > 0">
            <mat-select name="classroomSelected" [(ngModel)]="classroomSelected" (ngModelChange)="getStudentsUserByCurrentUserTeacher()" placeholder="Classes">
                <mat-option *ngFor="let classroom of classrooms" [value]="classroom.id">
                    {{ classroom.entitled }} - {{ classroom.option }} - {{ classroom.division }}
                </mat-option>
            </mat-select>
        </mat-form-field>

        <mat-form-field *ngIf="classroomSelected">
            <mat-select name="userSelected" [(ngModel)]="userSelected" (ngModelChange)="getStudentUserByCurrentUserTeacher()" placeholder="Etudiants">
                <mat-option *ngFor="let user of users" [value]="user.id">
                    {{ user.firstName }} -  {{ user.lastName }}
                </mat-option>
            </mat-select>
        </mat-form-field>

        <button type="submit" class="btn btn-dark" name="validate" (click)="saveMarks()"> Valider </button>

        <br/><label for="yearPeriod"> Période : </label><input type="text" name="yearPeriod" [(ngModel)]="yearPeriod" id="yearPeriod" required>

        <input type="text" placeholder="Module" aria-label="Number" matInput [(ngModel)]="idModule"  [matAutocomplete]="auto">
        <mat-autocomplete #auto="matAutocomplete">
            <mat-option *ngFor="let module of modules" [value]="module.id">
                {{ module.entitled }}
            </mat-option>
        </mat-autocomplete>

        <div *ngIf="classroomSelected">
            <table class="table table-striped tab">
                <thead>
                <tr>
                    <th scope="col"> # </th>
                    <th scope="col"> Prénom </th>
                    <th scope="col"> Nom </th>
                    <th scope="col"> Moyenne </th>
                    <th scope="col"> Commentaire </th>
                </tr>
                </thead>
                <tbody>
                <tr *ngFor="let user of users">
                    <td scope="row"></td>
                    <td> {{user.firstName}} </td>
                    <td> {{user.lastName}}</td>
                    <td> <input type="text" name="mark" [(ngModel)]="marks[user.id]" id="fieldAverage" maxlength="2"> </td>
                    <td> <textarea name="comment" [(ngModel)]="comments[user.id]" id="fieldComment" rows="2"></textarea> </td>
                </tr>
                </tbody>
            </table>
        </div>

    </mat-tab>

    <!-- Relevé de notes -->
    <mat-tab label="Relevé de notes">
        <span>Relevé de notes</span>
        <!-- Liste déroulante -->
        <mat-form-field>
            <mat-select name="schoolSelectedReport" [(ngModel)]="schoolSelectedReport" (ngModelChange)="getClassroomsByCurrentUserTeacherReport()" placeholder="Ecoles">
                <mat-option *ngFor="let school of schoolsReport" [value]="school.id">
                    {{ school.wording }} - {{school.city}}
                </mat-option>
            </mat-select>
        </mat-form-field>

        <mat-form-field *ngIf="schoolSelectedReport && this.classroomsReport.length > 0">
            <mat-select name="classroomSelectedReport" [(ngModel)]="classroomSelectedReport" (ngModelChange)="getStudentsUserByCurrentUserTeacherReport()" placeholder="Classes">
                <mat-option *ngFor="let classroom of classroomsReport" [value]="classroom.id">
                    {{ classroom.entitled }} - {{ classroom.option }} - {{ classroom.division }}
                </mat-option>
            </mat-select>
        </mat-form-field>

        <mat-form-field *ngIf="classroomSelectedReport">
            <mat-select name="userSelectedReport" [(ngModel)]="userSelectedReport" (ngModelChange)="getStudentUserByCurrentUserTeacherReport()" placeholder="Etudiants">
                <mat-option *ngFor="let user of usersReport" [value]="user.id">
                    {{ user.firstName }} -  {{ user.lastName }}
                </mat-option>
            </mat-select>
        </mat-form-field>


        <div *ngIf="classroomSelectedReport">
            <table class="table table-striped tab">
                <thead>
                <tr>
                    <th scope="col"> # </th>
                    <th scope="col"> Prénom </th>
                    <th scope="col"> Nom </th>
                </tr>
                </thead>
                <tbody>
                <tr *ngFor="let user of usersReport">
                    <td scope="row"></td>
                    <td> {{user.firstName}} </td>
                    <td> {{user.lastName}}</td>
                </tr>
                </tbody>
            </table>
        </div>
    </mat-tab>

    <!-- Graphe -->
    <mat-tab label="Graphe">
        <!-- Listes déroulante -->
        <mat-form-field>
            <mat-select name="schoolSelected" [(ngModel)]="schoolSelectedGraph" (ngModelChange)="getClassroomsByCurrentUserTeacherGraph()" placeholder="Ecoles">
                <mat-option *ngFor="let school of schoolsGraph" [value]="school.id">
                    {{ school.wording }} - {{school.city}}
                </mat-option>
            </mat-select>
        </mat-form-field>

        <mat-form-field *ngIf="schoolSelectedGraph && this.classroomsGraph.length > 0">
            <mat-select name="classroomSelected" [(ngModel)]="classroomSelectedGraph" (ngModelChange)="getStudentsUserByCurrentUserTeacherGraph() && this.loadChartData()" placeholder="Classes">
                <mat-option *ngFor="let classroom of classroomsGraph" [value]="classroom.id">
                    {{ classroom.entitled }} - {{ classroom.option }} - {{ classroom.division }}
                </mat-option>
            </mat-select>
        </mat-form-field>

        <mat-form-field *ngIf="classroomSelectedGraph">
            <mat-select name="userSelected" [(ngModel)]="userSelectedGraph" (ngModelChange)="getStudentUserByCurrentUserTeacherGraph()" placeholder="Etudiants">
                <mat-option *ngFor="let user of usersGraph" [value]="user.id">
                    {{ user.firstName }} -  {{ user.lastName }}
                </mat-option>
            </mat-select>
        </mat-form-field>
        <div style="width: 40%;" *ngIf="this.containsData">
            <canvas
                baseChart
                [chartType]="'line'"
                [datasets]="chartData"
                [labels]="chartLabels"
                [options]="chartOptions"
                [legend]="true"
                (chartClick)="onChartClick($event)">
            </canvas>
        </div>
    </mat-tab>

</mat-tab-group>

<img src="../../content/images/printer.svg" style="display:none;">
<img src="../../content/images/upload.svg" style="display:none;">
